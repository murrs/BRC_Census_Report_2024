```{r, echo=FALSE}
knitr::opts_chunk$set(fig.pos = "H", out.extra = "", echo = FALSE,
                      warning = FALSE, message = FALSE)
```

```{r}
library(data.table)
library(survey)
library(ggplot2)
library(scales)
library(knitr)
library(kableExtra)
library(weights)
source(paste0(getwd(), "/_RCode/read_census_data.R"))
source(paste0(getwd(), "/_RCode/make_table_data.R"))
source(paste0(getwd(), "/_RCode/make_plot_data.R"))
source(paste0(getwd(), "/_RCode/additional_functions.R"))

gradientColors <- colorRampPalette(c("#EA008B", "#B0AEDC", "#554149"))
discreteColors <- c("#EA008B", "#B0AEDC", "#554149", "#A07200", "#AADA91", 
                    "#FF8189", "#FFCF50", "#6FCFEB", "#76236C", "#FFFF3B")
```

# Beyond the Burn -- regionals, media, and volunteering

## Regionals

### Attended any regional Burning Man events/mixers/gatherings

```{r}
attendRegional <- makePlotData("Have you ever attended any Regional Burning Man events/mixers/gatherings?",
                               varNameTable = varNameTable,
                               designs = list(design13, design14, design15,
                                              design16, design17, design18,
                                              design19, design22, design23,
                                              design24),
                               years = c(2013:2019, 2022:2024),
                               levels = c(rep(list(c(c("Yes_attended",
                                                       "No_but_email_list",
                                                       "No",
                                                       "Yes_volunteered"))), times = 7),
                                          rep(list(c("Attended at least one regional",
                                                 "Not attended, on e-mail list",
                                                 "Not connected to regional",
                                                 "Volunteered with a regional")), times = 2),
                                          rep(list(c("Yes, I have attended at least one Regional Burning Man Event",
                                                 "No, but I am on an email list for Regional Burners",
                                                 "No, I am not connected to my Regional Burning Man community",
                                                 "Yes, and I volunteered with a Regional Burning Man Event")), times = 2)),
                               labels = c("Attended at least \n one regional",
                                          "Not attended, \n on e-mail list",
                                          "Not connected \n to regional",
                                          "Volunteered with \n a regional"),
                               labelOrder = c(4,1,2,3))
attendRegional$attend <- rep(c("Attended or \n volunteered with \n a regional event", 
                               "Did not attend a \n regional event", 
                               "Did not attend a \n regional event", 
                               "Attended or \n volunteered with \n a regional event"), times = 10)


ggplot(attendRegional, aes(x = year, y = est, fill = labels)) +
  geom_bar(stat = "identity") +
  theme_bw() +
  theme(panel.grid.minor = element_blank(),
        axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +
  scale_x_continuous(breaks = c(2013:2019, 2022:2024), labels = c(2013:2019, 2022:2024)) +
  scale_y_continuous(labels = percent, limits = c(0, NA)) +
  scale_fill_manual(values = discreteColors[c(2,1,3,4)]) +
  labs(y = "Burning Man participants (%)", 
       fill = "Regional event connection",
       title = "Have you ever attended any Regional Burning Man events/mixers/gatherings?") +
  facet_wrap(~attend)

makeTableData(attendRegional) |>
  kbl(col.names = c(2013:2019, 2022:2024),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:11, width_min = "10.5em") |>
  scroll_box(width = "100%")

```

### Involvement with a regional Burning Man event

```{r}
# #Creating not involve variables to match 2022 not involve level
design24$variables$regionalInvolved.notInvolved <- !design24$variables$regionalInvolved.production &
  !design24$variables$regionalInvolved.staffVolunteer &
  !design24$variables$regionalInvolved.medical &
  !design24$variables$regionalInvolved.art &
  !design24$variables$regionalInvolved.themeCamp &
  !design24$variables$regionalInvolved.vendor &
  !design24$variables$regionalInvolved.performance &
  !design24$variables$regionalInvolved.other
design23$variables$regionalInvolved.notInvolved <- !design23$variables$regionalInvolved.production &
  !design23$variables$regionalInvolved.staffVolunteer &
  !design23$variables$regionalInvolved.medical &
  !design23$variables$regionalInvolved.art &
  !design23$variables$regionalInvolved.themeCamp &
  !design23$variables$regionalInvolved.vendor &
  !design23$variables$regionalInvolved.performance &
  !design23$variables$regionalInvolved.other
design22$variables$regionalInvolved.notInvolved <- !design22$variables$regionalInvolved.production &
  !design22$variables$regionalInvolved.staffVolunteer &
  !design22$variables$regionalInvolved.medical &
  !design22$variables$regionalInvolved.art &
  !design22$variables$regionalInvolved.themeCamp &
  !design22$variables$regionalInvolved.vendor &
  !design22$variables$regionalInvolved.performance &
  !design22$variables$regionalInvolved.other
design19$variables$bminvolve_not <- ifelse(design19$variables$bminvolve_prod == "no" &
                                             design19$variables$bminvolve_staf == "no" &
                                             design19$variables$bminvolve_medic == "no" &
                                             design19$variables$bminvolve_art == "no" &
                                             design19$variables$bminvolve_camp == "no" &
                                             design19$variables$bminvolve_vendor == "no" &
                                             design19$variables$bminvolve_perfo == "no" &
                                             design19$variables$bminvolve_other == "no",
                                           "yes", "no")
design18$variables$bminvolve_not <- ifelse(design18$variables$bminvolve_prod == "no" &
                                             design18$variables$bminvolve_art == "no" &
                                             design18$variables$bminvolve_camp == "no" &
                                             design18$variables$bminvolve_vendor == "no" &
                                             design18$variables$bminvolve_perfo == "no" &
                                             design18$variables$bminvolve_other == "no",
                                           "yes", "no")
design17$variables$bminvolve_not <- ifelse(design17$variables$bminvolve_prod == "no" &
                                             design17$variables$bminvolve_art == "no" &
                                             design17$variables$bminvolve_camp == "no" &
                                             design17$variables$bminvolve_vendor == "no" &
                                             design17$variables$bminvolve_perfo == "no" &
                                             design17$variables$bminvolve_other == "no",
                                           "yes", "no")
design16$variables$bminvolve_not <- ifelse(design16$variables$bminvolve_prod == "no" &
                                             design16$variables$bminvolve_art == "no" &
                                             design16$variables$bminvolve_camp == "no" &
                                             design16$variables$bminvolve_vendor == "no" &
                                             design16$variables$bminvolve_perfo == "no" &
                                             design16$variables$bminvolve_other == "no",
                                           "yes", "no")
design15$variables$bminvolve_not <- ifelse(design15$variables$bminvolve_prod == "no" &
                                             design15$variables$bminvolve_art == "no" &
                                             design15$variables$bminvolve_camp == "no" &
                                             design15$variables$bminvolve_vendor == "no" &
                                             design15$variables$bminvolve_perfo == "no" &
                                             design15$variables$bminvolve_other == "no",
                                           "yes", "no")

design15.regionalInvolved <- subset(design15, bminvolve_not == "no")
design16.regionalInvolved <- subset(design16, bminvolve_not == "no")
design17.regionalInvolved <- subset(design17, bminvolve_not == "no")
design18.regionalInvolved <- subset(design18, bminvolve_not == "no")
design19.regionalInvolved <- subset(design19, bminvolve_not == "no")
design22.regionalInvolved <- subset(design22, !regionalInvolved.notInvolved)
design23.regionalInvolved <- subset(design23, !regionalInvolved.notInvolved)
design24.regionalInvolved <- subset(design24, !regionalInvolved.notInvolved)

regionalInvolve <- makePlotData("In what ways have you been involved with a Regional Burning Man Event?",
                                varNameTable = varNameTable,
                                designs = list(design15.regionalInvolved, 
                                               design16.regionalInvolved, 
                                               design17.regionalInvolved,
                                               design18.regionalInvolved, 
                                               design19.regionalInvolved, 
                                               design22.regionalInvolved,
                                               design23.regionalInvolved,
                                               design24.regionalInvolved),
                                years = c(2015:2019, 2022:2024),
                                levels = c(as.list(rep("yes", times = 5)),
                                           rep(list(TRUE), times = 3)),
                                labels = c("Production",
                                           "Staff/volunteer",
                                           "Medical services",
                                           "Art project",
                                           "Theme camp",
                                           "Vendor",
                                           "Performance",
                                           "Other",
                                           "Donor",
                                           "Supporter",
                                           "Not involved"))

# #2022 and 2023 results are all false for Not involved, dropping from analysis
regionalInvolve <- regionalInvolve[regionalInvolve$labels != "Not involved",]
regionalInvolve$labels <- factor(regionalInvolve$labels,
                                 levels = c("Staff/volunteer",
                                            "Theme camp",
                                            "Art project",
                                            "Production",
                                            "Performance",
                                            "Medical services",
                                            "Vendor",
                                            "Not involved",
                                            "Donor",
                                            "Supporter",
                                            "Other"))

# # ggplot(regionalInvolve, aes(x = year, y = est, color = labels)) +
# #   geom_line(linewidth = 1.5, alpha = 0.7) +
# #   geom_point(size = 2.25) +
# #   theme_bw() +
# #   theme(panel.grid.minor = element_blank()) +
# #   scale_x_continuous(breaks = c(2014:2019, 2022:2023), 
# #                      labels = c(2014:2019, 2022:2023)) +
# #   scale_y_continuous(labels = percent, limits = c(0, NA)) +
# #   scale_color_manual(values = discreteColors[1:9]) +
# #   labs(x = "Year", y = "Burning Man participants with involvement in regionals (%)", 
# #        color = "Brought children?",
# #        title = "Have you ever brought children under 18 to Black Rock City?")

ggplot(regionalInvolve[regionalInvolve$year == 2024,], aes(x = labels, y = est)) +
  geom_bar(stat = "identity", fill = "#EA008B") +
  scale_y_continuous(labels = percent) +
  labs(x = "Involvement with a Burning Man regional", 
       y = "Burning Man participants with involvement \n in regional events in 2023 (%)",
       title = "In what ways have you been involved with a Regional Burning Man Event?") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))

regionalInvolve2 <- makePlotData("In what ways have you been involved with a Regional Burning Man Event?",
                                varNameTable = varNameTable,
                                designs = list(design15, 
                                               design16, 
                                               design17,
                                               design18, 
                                               design19, 
                                               design22,
                                               design23,
                                               design24),
                                years = c(2015:2019, 2022:2024),
                                levels = c(as.list(rep("yes", times = 5)),
                                           rep(list(TRUE), times = 3)),
                                labels = c("Production",
                                           "Staff/volunteer",
                                           "Medical services",
                                           "Art project",
                                           "Theme camp",
                                           "Vendor",
                                           "Performance",
                                           "Other",
                                           "Donor",
                                           "Supporter",
                                           "Not involved"))

makeTableData(regionalInvolve2) |>
  kbl(col.names = c(2015:2019, 2022:2024),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:9, width_min = "10.5em") |>
  scroll_box(width = "100%")
```

## Burning Man Media

<!-- There is something wrong with the responses in 2022 and 2023, every category has too many TRUEs -->

### Media manged by Burning Man

```{r}
BMMedia.never <- makePlotData("Which of the following media managed by Burning Man Project do you use to receive news, information, and events related to Burning Man, and to engage in discussion on Burning Man topics?",
                        varNameTable = varNameTable,
                        designs = list(design15, design16, design17,
                                       design18, design19, design22,
                                       design23, design24),
                        years = c(2015:2019, 2022:2024),
                        levels = c(as.list(rep("Never", times = 8))),
                        labels = c("Jack Rabbit Speaks \n e-newsletter",
                                   "Burning Man Website",
                                   "Burning Man Journal",
                                   "Burning Man Hive",
                                   "Social Media managed by \n Burning Man",
                                   "Eplaya message board"))

BMMedia.rarely <- makePlotData("Which of the following media managed by Burning Man Project do you use to receive news, information, and events related to Burning Man, and to engage in discussion on Burning Man topics?",
                        varNameTable = varNameTable,
                        designs = list(design15, design16, design17,
                                       design18, design19, design22,
                                       design23, design24),
                        years = c(2015:2019, 2022:2024),
                        levels = c(as.list(rep("Rarely", times = 8))),
                        labels = c("Jack Rabbit Speaks \n e-newsletter",
                                   "Burning Man Website",
                                   "Burning Man Journal",
                                   "Burning Man Hive",
                                   "Social Media managed by \n Burning Man",
                                   "Eplaya message board"))

BMMedia.often <- makePlotData("Which of the following media managed by Burning Man Project do you use to receive news, information, and events related to Burning Man, and to engage in discussion on Burning Man topics?",
                        varNameTable = varNameTable,
                        designs = list(design15, design16, design17,
                                       design18, design19, design22,
                                       design23, design24),
                        years = c(2015:2019, 2022:2024),
                        levels = c(as.list(rep("Often", times = 8))),
                        labels = c("Jack Rabbit Speaks \n e-newsletter",
                                   "Burning Man Website",
                                   "Burning Man Journal",
                                   "Burning Man Hive",
                                   "Social Media managed by \n Burning Man",
                                   "Eplaya message board"))

BMMedia <- rbind(BMMedia.never, BMMedia.rarely, BMMedia.often)
BMMedia$level <- factor(BMMedia$level, levels = c("Never", "Rarely", "Often"))

ggplot(BMMedia, aes(x = year, y = est, fill = level)) +
 geom_bar(stat = "identity") +
 scale_y_continuous(labels = percent) +
 scale_x_continuous(breaks = c(2014:2019, 2022:2024),
                    labels = c(2014:2019, 2022:2024)) +
 scale_fill_manual(values = gradientColors(3)[3:1]) +
 labs(x = "Media source", y = "",
      fill = "Frequency",
      title = "Which of the following media managed by Burning Man Project do you use \n to receive news, information, and events related to Burning Man, \n and to engage in discussion on Burning Man topics?") +
 theme_bw() +
 theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
       panel.grid.minor = element_blank()) +
 guides(fill = guide_legend(reverse = TRUE)) +
 facet_wrap(~labels, nrow = 2)

BMMedia2 <- BMMedia

BMMedia2$labels <- factor(paste0(BMMedia2$labels, " (", BMMedia2$level, ")"))
BMMedia2$labels <- factor(BMMedia2$labels, 
                             levels = levels(BMMedia2$labels)[c(1,3,2,4,6,5,7,9,8,
                                                                10,12,11,13,15,14,
                                                                16,18,17,19,21,20,
                                                                22,24,23,25,27,26,
                                                                28,30,29,31,33,32,
                                                                34,36,35,37,39,38,
                                                                40,42,41,43,45,44,
                                                                46,48,47)])

makeTableData(BMMedia2) |>
  kbl(col.names = c(2015:2019, 2022:2024),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:9, width_min = "10.5em") |>
  scroll_box(width = "100%")
```

### Media not managed by Burning Man Project

<!-- Not sure about pre-2022 years.  Some digging needs to be done. -->

<!-- Questions are missing completely from 2019 -->

```{r}
# notBMMedia.never <- makePlotData("Which of the following media NOT managed by Burning Man Project do you use to receive news and information concerning Burning Man?",
#                         varNameTable = varNameTable,
#                         designs = list(design22, design23, design24),
#                         years = c(2022:2024),
#                         levels = c(as.list(rep("Never", times = 7))),
#                         labels = c("Social media or discussion \n lists from established \n Burning Man camps",
#                                    "Regional newsletter or social \n media managed by Regional \n event organizers",
#                                    "Regional website",
#                                    "Regional discussion \n list",
#                                    "Other social \n media",
#                                    "Other websites, \n blogs or podcasts",
#                                    "Other discussion \n lists",
#                                    "Word of mouth"))
# 
# notBMMedia.rarely <- makePlotData("Which of the following media NOT managed by Burning Man Project do you use to receive news and information concerning Burning Man?",
#                         varNameTable = varNameTable,
#                         designs = list(design22, design23, design24),
#                         years = c(2022:2024),
#                         levels = c(as.list(rep("Rarely", times = 7))),
#                         labels = c("Social media or discussion \n lists from established \n Burning Man camps",
#                                    "Regional newsletter or social \n media managed by Regional \n event organizers",
#                                    "Regional website",
#                                    "Regional discussion \n list",
#                                    "Other social \n media",
#                                    "Other websites, \n blogs or podcasts",
#                                    "Other discussion \n lists",
#                                    "Word of mouth"))
# 
# notBMMedia.often <- makePlotData("Which of the following media NOT managed by Burning Man Project do you use to receive news and information concerning Burning Man?",
#                         varNameTable = varNameTable,
#                         designs = list(design22, design23, design24),
#                         years = c(2022:2024),
#                         levels = c(as.list(rep("Often", times = 7))),
#                         labels = c("Social media or discussion \n lists from established \n Burning Man camps",
#                                    "Regional newsletter or social \n media managed by Regional \n event organizers",
#                                    "Regional website",
#                                    "Regional discussion \n list",
#                                    "Other social \n media",
#                                    "Other websites, \n blogs or podcasts",
#                                    "Other discussion \n lists",
#                                    "Word of mouth"))
# 
# notBMMedia <- rbind(notBMMedia.never, notBMMedia.rarely, notBMMedia.often)
# notBMMedia$level <- factor(notBMMedia$level, levels = c("Never", "Rarely", "Often"))
# 
# ggplot(notBMMedia, aes(x = year, y = est, fill = level)) +
#   geom_bar(stat = "identity") +
#   scale_y_continuous(labels = percent) +
#   scale_x_continuous(breaks = c(2022:2024),
#                      labels = c(2022:2024)) +
#   scale_fill_manual(values = gradientColors(3)[3:1]) +
#   labs(x = "Media source", y = "",
#        fill = "Frequency",
#        title = "Which of the following media NOT managed by Burning Man Project \n do you use to receive news and information concerning Burning Man?") +
#   theme_bw() +
#   theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
#         panel.grid.minor = element_blank()) +
#   guides(fill = guide_legend(reverse = TRUE)) +
#   facet_wrap(~labels, ncol = 3)
# 
# notBMMedia2 <- notBMMedia
# 
# notBMMedia2$labels <- factor(paste0(notBMMedia2$labels, " (", notBMMedia2$level, ")"))
# notBMMedia2$labels <- factor(notBMMedia2$labels, 
#                              levels = levels(notBMMedia2$labels)[c(1,3,2,4,6,5,7,9,8,
#                                                                    10,12,11,13,15,14,
#                                                                    16,18,17,19,21,20,
#                                                                    22,24,23,25,27,26,
#                                                                    28,30,29,31,33,32,
#                                                                    34,36,35,37,39,38,
#                                                                    40,42,41,43,45,44,
#                                                                    46,48,47)])
# 
# makeTableData(notBMMedia2) |>
#   kbl(col.names = c(2022:2024),
#       row.names = TRUE) |>
#   kable_paper("striped", full_width = F) |>
#   kable_styling() |>
#   column_spec(column = 1:3, width_min = "10.5em") |>
#   scroll_box(width = "100%")

notBMMedia.never <- makePlotData("Which of the following forms of communication NOT managed by Burning Man Project do you use to receive news and information concerning Burning Man?",
                        varNameTable = varNameTable,
                        designs = list(design22, design23, design24),
                        years = c(2022:2024),
                        levels = c(as.list(rep("Never", times = 7))),
                        labels = c("Social media or discussion \n lists from established \n Burning Man camps",
                                   "Regional newsletter or social \n media managed by Regional \n event organizers",
                                   "Regional website",
                                   "Regional discussion \n list",
                                   "Other social \n media",
                                   "Other websites, \n blogs or podcasts",
                                   "Other discussion \n lists",
                                   "Word of mouth"))

notBMMedia.rarely <- makePlotData("Which of the following forms of communication NOT managed by Burning Man Project do you use to receive news and information concerning Burning Man?",
                        varNameTable = varNameTable,
                        designs = list(design22, design23, design24),
                        years = c(2022:2024),
                        levels = c(as.list(rep("Rarely", times = 7))),
                        labels = c("Social media or discussion \n lists from established \n Burning Man camps",
                                   "Regional newsletter or social \n media managed by Regional \n event organizers",
                                   "Regional website",
                                   "Regional discussion \n list",
                                   "Other social \n media",
                                   "Other websites, \n blogs or podcasts",
                                   "Other discussion \n lists",
                                   "Word of mouth"))

notBMMedia.often <- makePlotData("Which of the following forms of communication NOT managed by Burning Man Project do you use to receive news and information concerning Burning Man?",
                        varNameTable = varNameTable,
                        designs = list(design22, design23, design24),
                        years = c(2022:2024),
                        levels = c(as.list(rep("Often", times = 7))),
                        labels = c("Social media or discussion \n lists from established \n Burning Man camps",
                                   "Regional newsletter or social \n media managed by Regional \n event organizers",
                                   "Regional website",
                                   "Regional discussion \n list",
                                   "Other social \n media",
                                   "Other websites, \n blogs or podcasts",
                                   "Other discussion \n lists",
                                   "Word of mouth"))

notBMMedia <- rbind(notBMMedia.never, notBMMedia.rarely, notBMMedia.often)
notBMMedia$level <- factor(notBMMedia$level, levels = c("Never", "Rarely", "Often"))

ggplot(notBMMedia, aes(x = year, y = est, fill = level)) +
  geom_bar(stat = "identity") +
  scale_y_continuous(labels = percent) +
  scale_x_continuous(breaks = c(2022:2024),
                     labels = c(2022:2024)) +
  scale_fill_manual(values = gradientColors(3)[3:1]) +
  labs(x = "Media source", y = "",
       fill = "Frequency",
       title = "Which of the following media NOT managed by Burning Man Project \n do you use to receive news and information concerning Burning Man?") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
        panel.grid.minor = element_blank()) +
  guides(fill = guide_legend(reverse = TRUE)) +
  facet_wrap(~labels, ncol = 3)

notBMMedia2 <- notBMMedia

notBMMedia2$labels <- factor(paste0(notBMMedia2$labels, " (", notBMMedia2$level, ")"))
notBMMedia2$labels <- factor(notBMMedia2$labels,
                             levels = levels(notBMMedia2$labels)[c(1,3,2,4,6,5,7,9,8,
                                                                   10,12,11,13,15,14,
                                                                   16,18,17,19,21,20,
                                                                   22,24,23,25,27,26,
                                                                   28,30,29,31,33,32,
                                                                   34,36,35,37,39,38,
                                                                   40,42,41,43,45,44,
                                                                   46,48,47)])

makeTableData(notBMMedia2) |>
  kbl(col.names = c(2022:2024),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:4, width_min = "10.5em") |>
  scroll_box(width = "100%")
```

### Most valuable types of information coming from Burning Man Project

```{r}
valuableInfo <- makePlotData("What types of information do you find most valuable coming from Burning Man Project?",
                                varNameTable = varNameTable,
                                designs = list(design14, design15, design16,
                                               design17, design18, design19,
                                               design22, design23, design24),
                                years = c(2014:2019, 2022:2024),
                                levels = c(as.list(rep("yes", times = 6)),
                                           as.list(rep(TRUE, times = 3))),
                                labels = c("Black Rock City events",
                                           "Bay Area events",
                                           "Events around the world",
                                           "Burning Man Regional events",
                                           "Volunteer opportunities with \n teams or departments",
                                           "Opportunities to create \n or assist with art",
                                           "Black Rock City preparation \n information",
                                           "Information about camps",
                                           "Photos and videos from \n Black Rock City",
                                           "Stories about Burners from \n around the world",
                                           "Information about non-profit \n activities",
                                           "Information supporting R.I.D.E.",
                                           "Resources about sustainability \n at Burning Man",
                                           "Other"),
                             labelOrder = rev(c(1, 7, 9, 4, 5, 6, 8, 10, 13, 
                                            3, 2, 12, 11, 14)))

ggplot(valuableInfo[valuableInfo$year == 2024,], aes(x = labels, y = est)) +
  geom_bar(stat = "identity", fill = "#EA008B") +
  scale_y_continuous(labels = percent) +
  labs(x = "Information type", y = "Burning Man participants in 2024 (%)",
       title = "What types of information do you find most valuable \n coming from Burning Man Project?") +
  theme_bw() +
  # theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
  coord_flip()

makeTableData(valuableInfo)[14:1,] |>
  kbl(col.names = c(2014:2019, 2022:2024),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:10, width_min = "10.5em") |>
  scroll_box(width = "100%")
```

### Listened to BMIR (Burning Man Information Radio) this year

<!-- Need to check what happened to bmir_online in 2016 -->

```{r}
bmir <- makePlotData("Have you listened to BMIR (Burning Man Information Radio) 94.5 FM this year?",
                     varNameTable = varNameTable,
                     designs = list(design14, design15, design16, design17,
                                    design18, design19, design22, design23,
                                    design24),
                     years = c(2014:2019, 2022:2024),
                     levels = c(as.list(rep("yes", times = 6)),
                                as.list(rep(TRUE, times = 3))),
                     labels = c("Listened online",
                                "Listened while traveled",
                                "Listened over the air at \n Black Rock City",
                                "Listened over speakers at \n BMIR or Center Camp",
                                "Did not know about BMIR",
                                "Knew about BMIR, but \n did not listen to it"))

ggplot(bmir, aes(x = year, y = est, color = labels)) +
  geom_line(linewidth = 1.5, alpha = 0.7) +
  geom_point(size = 2.25) +
  theme_bw() +
  theme(panel.grid.minor = element_blank()) +
  scale_x_continuous(breaks = c(2014:2019, 2022:2024), 
                     labels = c(2014:2019, 2022:2024)) +
  scale_y_continuous(labels = percent, limits = c(0, NA)) +
  scale_color_manual(values = discreteColors[1:6]) +
  labs(x = "Year", y = "Burning Man participants (%)", 
       color = "Burning Man Information \n Radio (BMIR) Source",
       title = "Have you listened to BMIR (Burning Man Information Radio) \n94.5 FM this year?")

makeTableData(bmir) |>
  kbl(col.names = c(2014:2019, 2022:2024),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:10, width_min = "10.5em") |>
  scroll_box(width = "100%")
```

### BMIR Usefulness

```{r}
bmirUseful <- makePlotData("Was BMIR (Burning Man Information Radio) 94.5 FM useful to you this year?",
                     varNameTable = varNameTable,
                     designs = list(design24),
                     years = c(2024),
                     levels = list(c("Always", "Never", "Often", "Sometimes")),
                     labels = c("Always",
                                "Never",
                                "Often",
                                "Sometimes"),
                     labelOrder = c(1,4,3,2))

ggplot(bmirUseful, aes(x = labels, y = est)) +
  geom_bar(stat = "identity", fill = "#EA008B") +
  scale_y_continuous(labels = percent) +
  labs(x = "Frequency of usefulness of BMIR", y = "Burning Man participants in 2024 (%)",
       title = "Was BMIR (Burning Man Information Radio) \n94.5 FM useful to you this year?") +
  theme_bw()

makeTableData(bmirUseful) |>
  kbl(col.names = c(2024),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:2, width_min = "10.5em") |>
  scroll_box(width = "100%")

makeTableData(bmirUseful) |>
  kbl(col.names = c(2024),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:2, width_min = "10.5em") |>
  scroll_box(width = "100%")
```


### Listened to GARS (Gate Advisory Radio) this year

<!-- Need to check what happened to bmir_online in 2016 -->

```{r}
gars <- makePlotData("Have you listened to GARS (Gate Advisory Radio) 95.1 this year?",
                     varNameTable = varNameTable,
                     designs = list(design24),
                     years = c(2024),
                     levels = c(as.list(rep(TRUE, times = 1))),
                     labels = c("I listened while inside Black Rock City",
                                "I listened on the way in to Black Rock City ONLY",
                                "I listened during Exodus ONLY",
                                "I listened on the way in and during Exodus",
                                "I listened in Gerlach"),
                     labelOrder = 5:1)

ggplot(gars, aes(x = labels, y = est)) +
  geom_bar(stat = "identity", fill = "#EA008B") +
  scale_y_continuous(labels = percent) +
  labs(x = "Frequency of usefulness of BMIR", y = "Burning Man participants in 2024 (%)",
       title = "Have you listened to GARS (Gate Advisory Radio) \n95.1 this year?") +
  coord_flip() +
  theme_bw()

makeTableData(gars)[5:1,] |>
  kbl(col.names = c(2024),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:2, width_min = "10.5em") |>
  scroll_box(width = "100%")
```

### GARS Usefulness

```{r}
garsUseful <- makePlotData("Was GARS (Gate Advisory Radio Station) 95.1 FM useful to you this year?",
                     varNameTable = varNameTable,
                     designs = list(design24),
                     years = c(2024),
                     levels = list(c("Always", "Never", "Often", "Sometimes")),
                     labels = c("Always",
                                "Never",
                                "Often",
                                "Sometimes"),
                     labelOrder = c(1,4,3,2))

ggplot(bmirUseful, aes(x = labels, y = est)) +
  geom_bar(stat = "identity", fill = "#EA008B") +
  scale_y_continuous(labels = percent) +
  labs(x = "Frequency of usefulness of BMIR", y = "Burning Man participants in 2024 (%)",
       title = "Was GARS (Gate Advisory Radio Station) \n95.1 FM useful to you this year?") +
  theme_bw()

makeTableData(garsUseful) |>
  kbl(col.names = c(2024),
      row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  kable_styling() |>
  column_spec(column = 1:2, width_min = "10.5em") |>
  scroll_box(width = "100%")
```


## Volunteerism and donations

### Volunteered in the last year

```{r}
# volunteer <- makePlotData("Have you volunteered for any of the following in the last year?",
#                           varNameTable = varNameTable,
#                           designs = list(design16, design17, design18,
#                                          design19, design22, design23,
#                                          design24),
#                           years = c(2016:2019, 2022:2024),
#                           levels = c(as.list(rep("yes", times = 4)),
#                                      as.list(rep(TRUE, times = 3))),
#                           labels = c("Black Rock City",
#                                      "Burning Man Regionals",
#                                      "Burners Without Borders",
#                                      "Fly Ranch Project",
#                                      "Art Projects",
#                                      "Political campaigns or \n voter registration",
#                                      "Schools or universities",
#                                      "Animals or environmental \n initiatives",
#                                      "Health-related initiatives",
#                                      "Human rights or poverty-\n related initiatives",
#                                      "Religious or faith-based \n initiatives",
#                                      "Community groups or clubs",
#                                      "Self-initiated good deeds",
#                                      "Other non-profits and \n charities"),
#                           labelOrder = c(14,3,4,11,6,9,2,7,8,10,1,5,12,13))
# 
# ggplot(volunteer[volunteer$year == 2023,], aes(x = labels, y = est)) +
#   geom_bar(stat = "identity", fill = "#EA008B") +
#   scale_y_continuous(labels = percent) +
#   labs(x = "Non-profit or charity", y = "Burning Man participants (%)") +
#   theme_bw() +
#   coord_flip()
# 
# makeTableData(volunteer)[14:1,] |>
#   kbl(col.names = c(2016:2019, 2022:2023), row.names = TRUE) |>
#   kable_paper("striped", full_width = F) |>
#   column_spec(column = 1:7, width_min = "10.5em") |>
#   kable_styling() |>
#   scroll_box(width = "100%")

volunteer <- makePlotData("Have you volunteered for any of the following in the last year?",
                          varNameTable = varNameTable,
                          designs = list(design16, design17, design18,
                                         design19, design22, design23,
                                         design24),
                          years = c(2016:2019, 2022:2024),
                          levels = c(as.list(rep("yes", times = 4)),
                                     as.list(rep(TRUE, times = 3))),
                          labels = c("Black Rock City",
                                     "Burning Man Regionals",
                                     "Burners Without Borders",
                                     "Fly Ranch Project",
                                     "Art Projects",
                                     "Political campaigns or \n voter registration",
                                     "Schools or universities",
                                     "Animals or environmental \n initiatives",
                                     "Health-related initiatives",
                                     "Human rights initiatives",
                                     "Poverty-related initiatives",
                                     "Religious or faith-\nbased initiatives",
                                     "Community groups or clubs",
                                     "Self-initiated good deeds",
                                     "Other non-profits and \n charities"),
                          labelOrder = c(15, 3, 4, 12, 11, 9, 10, 6, 2, 
                                         7, 8, 1, 5, 13, 14))

ggplot(volunteer[volunteer$year == 2024,], aes(x = labels, y = est)) +
  geom_bar(stat = "identity", fill = "#EA008B") +
  scale_y_continuous(labels = percent) +
  labs(x = "Non-profit or charity", y = "Burning Man participants (%)") +
  theme_bw() +
  coord_flip()

makeTableData(volunteer)[15:1,] |>
  kbl(col.names = c(2016:2019, 2022:2024), row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  column_spec(column = 1:8, width_min = "10.5em") |>
  kable_styling() |>
  scroll_box(width = "100%")
```

### Hours spent volunteering

```{r}
plotDat <- data.frame(hours = c(census24$volunteerHours,
                                census23$volunteerHours,
                                census22$volunteerHours,
                                census19$volunteerhours,
                                census18$volunteerhours),
                      year = as.factor(c(rep(2024, times = nrow(census24)),
                                         rep(2023, times = nrow(census23)),
                                         rep(2022, times = nrow(census22)),
                                         rep(2019, times = nrow(census19)),
                                         rep(2018, times = nrow(census18)))),
                      weights = c(census24$weights,
                                  census23$weights,
                                  census22$weights,
                                  census19$weightbfarrival,
                                  census18$weightbfarrival))
vh.wm <- c(as.numeric(svymean(~volunteerHours, design24, na.rm = TRUE)),
           as.numeric(svymean(~volunteerHours, design23, na.rm = TRUE)),
           as.numeric(svymean(~volunteerHours, design22, na.rm = TRUE)),
           as.numeric(svymean(~volunteerhours, design19, na.rm = TRUE)),
           as.numeric(svymean(~volunteerhours, design18, na.rm = TRUE)))
plotDat.weightedMean <- data.table(wm = vh.wm,
                                   year = as.factor(c(2024, 2023, 2022, 2019, 2018)))

ggplot(plotDat, aes(x = year, y = hours, weight = weights, group = year)) +
  geom_boxplot(width=0.6,  fill = "#EA008B", color = "black",
               alpha = 0.7) +
  geom_point(data = plotDat.weightedMean, aes(x = year, y = wm), shape = 23,
             size = 3, fill = "grey", inherit.aes = FALSE) +
  coord_trans(y = "sqrt") +
  theme_bw() +
  labs(x = "", y = "Hours", caption = "Diamond indicates weighted mean",
       title = "Approximately how many hours per month on average \n did you spend on
 volunteer efforts in the last year?") +
  scale_y_continuous(breaks = c(10, 25, 50, 100, 200, 400, 800)) +
  theme(panel.grid.minor = element_blank())

q2024 <- svyquantile(~volunteerHours, design24, c(0.10, 0.25, 0.5, 0.75, 0.90, 0.99),
                     na.rm = TRUE)$volunteerHours[,1:3]
q2023 <- svyquantile(~volunteerHours, design23, c(0.10, 0.25, 0.5, 0.75, 0.90, 0.99),
                     na.rm = TRUE)$volunteerHours[,1:3]
q2023 <- apply(q2023, 1, FUN = function(x){paste0(x[1], " (", x[2], ", ",
                                                  x[3], ")")})
q2022 <- svyquantile(~volunteerHours, design22, c(0.10, 0.25, 0.5, 0.75, 0.90, 0.99),
                     na.rm = TRUE)$volunteerHours[,1:3]
q2022 <- apply(q2022, 1, FUN = function(x){paste0(x[1], " (", x[2], ", ",
                                                  x[3], ")")})
q2019 <- svyquantile(~volunteerhours, design19, c(0.10, 0.25, 0.5, 0.75, 0.90, 0.99),
                     na.rm = TRUE)$volunteerhours[,1:3]
q2019 <- apply(q2019, 1, FUN = function(x){paste0(x[1], " (", x[2], ", ",
                                                  x[3], ")")})
q2018 <- svyquantile(~volunteerhours, design18, c(0.10, 0.25, 0.5, 0.75, 0.90, 0.99),
                     na.rm = TRUE)$volunteerhours[,1:3]
q2018 <- apply(q2018, 1, FUN = function(x){paste0(x[1], " (", x[2], ", ",
                                                  x[3], ")")})

tableDat <- data.frame(y2018 = q2018,
                       y2019 = q2019,
                       y2022 = q2022,
                       y2023 = q2023,
                       y2024 = q2024)
rownames(tableDat) <- c("10^th^ percentile",
                        "25^th^ percentile",
                        "Median",
                        "75^th^ percentile",
                        "90^th^ percentile",
                        "99^th^ percentile")
# kbl(tableDat, col.names = c(2018:2019, 2022:2024), row.names = TRUE) |>
#   kable_paper("striped", full_width = F) |>
#   column_spec(column = 1:5, width_min = "10.5em") |>
#   kable_styling() |>
#   scroll_box(width = "100%")
```

### Made a charitable donation in the last year

```{r}
# donation <- makePlotData("Have you made a charitable donation (of goods and/or money) toward any of the following in the last year?",
#                           varNameTable = varNameTable,
#                           designs = list(design19, design22, design23, design24),
#                           years = c(2019, 2022:2024),
#                           levels = c(as.list(rep("yes", times = 1)),
#                                      as.list(rep(TRUE, times = 3))),
#                           labels = c("Black Rock City",
#                                      "Burning Man Regionals",
#                                      "Burners Without Borders",
#                                      "Fly Ranch Project",
#                                      "Art Projects",
#                                      "Political campaigns or \n voter registration",
#                                      "Schools or universities",
#                                      "Animals or environmental \n initiatives",
#                                      "Health-related initiatives",
#                                      "Human rights or poverty-\n related initiatives",
#                                      "Religious or faith-based \n initiatives",
#                                      "Community groups or clubs",
#                                      "Self-initiated good deeds",
#                                      "Other non-profits and \n charities"),
#                           labelOrder = c(14, 4, 3, 11, 2, 7, 6, 1, 9, 5, 12, 13, 8, 10))
# 
# ggplot(donation, aes(x = labels, y = est, fill = as.factor(year))) +
#   geom_bar(stat = "identity", position = "dodge") +
#   scale_y_continuous(labels = percent) +
#   scale_fill_manual(values = discreteColors[3:1]) +
#   labs(x = "Non-profit or charity", y = "Burning Man participants (%)", 
#        fill = "Year",
#        title = "Have you made a charitable donation (of goods or money) \n toward any of the following in the last year?") +
#   theme_bw() +
#   coord_flip()
# 
# makeTableData(donation)[14:1,] |>
#   kbl(col.names = c(2019, 2022:2023), row.names = TRUE) |>
#   kable_paper("striped", full_width = F) |>
#   column_spec(column = 1:4, width_min = "10.5em") |>
#   kable_styling() |>
#   scroll_box(width = "100%")

donation <- makePlotData("Have you made a charitable donation (of goods and/or money) toward any of the following in the last year?",
                          varNameTable = varNameTable,
                          designs = list(design19, design22, 
                                         design23, design24),
                          years = c(2019, 2022:2024),
                          levels = c(as.list(rep("yes", times = 1)),
                                     as.list(rep(TRUE, times = 3))),
                          labels = c("Black Rock City",
                                     "Burning Man Regionals",
                                     "Burners Without Borders",
                                     "Fly Ranch Project",
                                     "Art Projects",
                                     "Political campaigns or \n voter registration",
                                     "Schools or universities",
                                     "Animals or environmental \n initiatives",
                                     "Health-related initiatives",
                                     "Human rights initiatives",
                                     "Poverty-\n related initiatives",
                                     "Religious or faith-based \n initiatives",
                                     "Community groups or clubs",
                                     "Self-initiated good deeds",
                                     "Other non-profits and \n charities"),
                          labelOrder = c(15, 4,3,2,12,7,1,9,
                                         13,5,6,8,11,14,10))

ggplot(donation, aes(x = labels, y = est, fill = as.factor(year))) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_y_continuous(labels = percent) +
  scale_fill_manual(values = discreteColors[4:1]) +
  labs(x = "Non-profit or charity", y = "Burning Man participants (%)",
       fill = "Year",
       title = "Have you made a charitable donation (of goods or money) \n toward any of the following in the last year?") +
  theme_bw() +
  theme(axis.text.y = element_text(size = 8)) +
  coord_flip()

makeTableData(donation)[15:1,] |>
  kbl(col.names = c(2019, 2022:2024), row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  column_spec(column = 1:5, width_min = "10.5em") |>
  kable_styling() |>
  scroll_box(width = "100%")
```

### Amount of money donated


### Inspiration to volunteer, donate, or get involved after going to Black Rock City

```{r}
inspiredVolunteer <- makePlotData("After going to Black Rock City, were you inspired to do more volunteering, donate more goods and/or money, or get more involved in your local community in general?",
                                  varNameTable = varNameTable,
                                  designs = list(design16, design17, design18,
                                                 design19, design22, design23,
                                                 design24),
                                  years = c(2016:2019, 2022:2024),
                                  levels = c("No", "Maybe", "Yes"),
                                  labels = c("No", "Maybe", "Yes"),
                                  labelOrder = 1:3)

ggplot(inspiredVolunteer, aes(x = year, y = est, fill = labels)) +
  geom_area(alpha = 0.65) +
  scale_y_continuous(labels = percent) +
  scale_x_continuous(breaks = c(2013:2019, 2022:2024), 
                     labels = c(2013:2019, 2022:2024)) +
  scale_fill_manual(values = gradientColors(3)[3:1]) +
  labs(x = "", y = "Burning Man participants (%)", 
       fill = "Inspired to volunteer after \n Black Rock City?",
       title = "After going to Black Rock City, were you inspired \n to do more volunteering, donate more goods or money, \n or get more involved in your local community in general?") +
  theme_bw()

makeTableData(inspiredVolunteer) |>
  kbl(col.names = c(2016:2019, 2022:2024), row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  column_spec(column = 1:8, width_min = "10.5em") |>
  kable_styling() |>
  scroll_box(width = "100%")
```

## New skills

### Inspiration to practice or learn skills after going to Black Rock City

```{r}
# skillsInspire <- makePlotData("After visiting Black Rock City, were you inspired to learn or practice any of the following skills?",
#                               varNameTable = varNameTable,
#                               designs = list(design16, design17, design18,
#                                              design19, design22, design23,
#                                              design24),
#                               years = c(2016:2019, 2022:2024),
#                               levels = c(as.list(rep("yes", times = 4)),
#                                          as.list(rep(TRUE, times = 3))),
#                               labels = c("Art creation/crafting",
#                                          "Performance art",
#                                          "Physical training",
#                                          "Leadership or interpersonal skills",
#                                          "Project management",
#                                          "Community organizing or \n civic engagement",
#                                          "Construction, heavy machinery, \n or mechanical work",
#                                          "Electrical engineering or \n electronics design",
#                                          "Carpentry or metal work",
#                                          "Graphic design",
#                                          "Mediation skills",
#                                          "Self-awareness or \n emotional skills",
#                                          "Self-care strategies",
#                                          "Survival skills",
#                                          "Other"),
#                               labelOrder = c(15,10,7,8,11,9,6,5,2,4,3,14,13,12,1))
# 
#ggplot(skillsInspire[skillsInspire$year == 2024,], aes(x = labels, y = est)) +
#  geom_bar(stat = "identity", fill = "#EA008B") +
#  scale_y_continuous(labels = percent) +
#  labs(x = "Skill learned or practiced", 
#       y = "Burning Man participants (%)", fill = "Year",
#       title = "After visiting Black Rock City, were you inspired \n to learn or practice any of the following skills?") +
#  theme_bw() +
#  coord_flip()
#
# makeTableData(skillsInspire)[15:1,] |>
#   kbl(col.names = c(2016:2019, 2022:2023), row.names = TRUE) |>
#   kable_paper("striped", full_width = F) |>
#   column_spec(column = 1:7, width_min = "10.5em") |>
#   kable_styling() |>
#   scroll_box(width = "100%")



skillsInspire <- makePlotData("After visiting Black Rock City, were you inspired to learn or practice any of the following skills?",
                              varNameTable = varNameTable,
                              designs = list(design16, design17, design18,
                                             design19, design22, design23,
                                             design24),
                              years = c(2016:2019, 2022:2024),
                              levels = c(as.list(rep("yes", times = 4)),
                                         as.list(rep(TRUE, times = 3))),
                              labels = c("Art creation/crafting",
                                         "Performance art",
                                         "Physical training",
                                         "Leadership or interpersonal skills",
                                         "Project management",
                                         "Community organizing or \n civic engagement",
                                         "Construction, heavy machinery, \n or mechanical work",
                                         "Electrical engineering or \n electronics design",
                                         "Carpentry or metal work",
                                         "Graphic design",
                                         "Mediation skills",
                                         "Run for political office",
                                         "Self-awareness or \n emotional skills",
                                         "Self-care strategies",
                                         "Survival skills",
                                         "Other"),
                              labelOrder = c(16,12,10,7,8,11,6,
                                             9,5,2,15,4,3,14,13,1))

ggplot(skillsInspire[skillsInspire$year == 2024,], aes(x = labels, y = est)) +
 geom_bar(stat = "identity", fill = "#EA008B") +
 scale_y_continuous(labels = percent) +
 labs(x = "Skill learned or practiced",
      y = "Burning Man participants (%)", fill = "Year",
      title = "After visiting Black Rock City, were you inspired \n to learn or practice any of the following skills?") +
 theme_bw() +
 coord_flip()

makeTableData(skillsInspire)[16:1,] |>
  kbl(col.names = c(2016:2019, 2022:2024), row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  column_spec(column = 1:8, width_min = "10.5em") |>
  kable_styling() |>
  scroll_box(width = "100%")
```

### Have any of these skills proved useful in the default world?

```{r}
skillsUseful <- makePlotData("Have any of these skills or experiences (honed by visiting Black Rock City) proved useful in the default world (beyond Black Rock City)?",
                              varNameTable = varNameTable,
                              designs = list(design16, design17, design18,
                                             design19, design22, design23,
                                             design24),
                              years = c(2016:2019, 2022:2024),
                              levels = c(rep(list(c("Not_for_now",
                                                    "Not_at_all",
                                                    "Yes_somewhat_useful",
                                                    "Yes_very_useful")), times = 4),
                                         rep(list(c("May be at some point",
                                                "Not at all",
                                                "Somewhat useful",
                                                "Very useful")), 
                                             times = 3)),
                              labels = c("May be at some point",
                                                "Not at all",
                                                "Somewhat useful",
                                                "Very useful"),
                              labelOrder = c(4, 3, 1, 2))

ggplot(skillsUseful, aes(x = year, y = est, color = labels)) +
  geom_line(linewidth = 1.5) +
  geom_point(size = 2.25, color = "black") +
  theme_bw() +
  theme(panel.grid.minor = element_blank()) +
  scale_x_continuous(breaks = c(2016:2019, 2022:2024),
                     labels = c(2016:2019, 2022:2024)) +
  scale_y_continuous(labels = percent, limits = c(0, NA)) +
  scale_color_manual(values = gradientColors(4)) +
  labs(x = "Year", y = "Burning Man participants (%)",
       color = "Skills useful in the \n default world",
       title = "Have any of these skills or experiences (honed by visiting Black Rock City) \nproved useful in the default world (beyond Black Rock City)?")

makeTableData(skillsUseful) |>
  kbl(col.names = c(2016:2019, 2022:2024), row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  column_spec(column = 1:8, width_min = "10.5em") |>
  kable_styling() |>
  scroll_box(width = "100%")
```

### How are you using these skills outside of Black Rock City?

```{r}
skillsOutside <- makePlotData("How are you using these same skills or experiences outside of Black Rock City?",
                              varNameTable = varNameTable,
                              designs = list(design17, design18, design19,
                                             design22, design23, design24),
                              years = c(2017:2019, 2022:2024),
                              levels = c(as.list(rep("yes", times = 3)),
                                           as.list(rep(TRUE, times = 3))),
                              labels = c("I am creating things for \n myself or my family",
                                         "I am creating things for \n my home community",
                                         "I am teaching those skills to \n members of my home community",
                                         "I am using my time at home to create things that \n I will bring to Black Rock City",
                                         "I am not using these skills \n outside of Black Rock City"),
                              labelOrder = c(1,4,2,3,5))

ggplot(skillsOutside, aes(x = year,
                          y = est, fill = labels)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_y_continuous(labels = percent) +
  scale_x_continuous(breaks = c(2017:2019, 2022:2024), labels = c(2017:2019, 2022:2024)) +
  labs(x = "",
       y = "Burning Man participants (%)", fill = "Uses for skills",
       title = "How are you using these same skills or experiences outside of Black Rock City?") +
  theme_bw() +
  theme(panel.grid.minor = element_blank()) +
  scale_fill_manual(values = discreteColors[1:6])

makeTableData(skillsOutside) |>
  kbl(col.names = c(2017:2019, 2022:2024), row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  column_spec(column = 1:7, width_min = "10.5em") |>
  kable_styling() |>
  scroll_box(width = "100%")
```

### Impact of these new skills outside of Black Rock City

```{r}
skillsImpact <- makePlotData("How are these new skills impacting your life outside of Black Rock City?",
                             varNameTable = varNameTable,
                             designs = list(design18, design19, design22, design23, design24),
                             years = c(2018:2019, 2022:2024),
                             levels = c(as.list(rep("yes", times = 2)),
                                        as.list(rep(TRUE, times = 3))),
                             labels = c("I am developing new and \n fulfilling relationships \n in my home community",
                                        "I feel more fulfilled as \n an individual \n",
                                        "These skills are not \n impacting my life outside of \n Black Rock City"),
                             labelOrder = c(2,1,3))

ggplot(skillsImpact, aes(x = year,
                          y = est, fill = labels)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_y_continuous(labels = percent) +
  labs(x = "Impact", y = "Burning Man participants (%)", 
       fill = "Impact of these skills",
       title = "How are these new skills impacting your life outside of Black Rock City?") +
  theme_bw() +
  scale_fill_manual(values = discreteColors[1:3])

makeTableData(skillsImpact) |>
  kbl(col.names = c(2018:2019, 2022:2024), row.names = TRUE) |>
  kable_paper("striped", full_width = F) |>
  column_spec(column = 1:6, width_min = "10.5em") |>
  kable_styling() |>
  scroll_box(width = "100%")
```
